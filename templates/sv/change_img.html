<html>
<head>
<title>Ändra bild</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<link rel="stylesheet" href="@imcmscssurl@/imcms_admin_ns.css" type="text/css">
<script src="@imcmsscripturl@/imcms_admin.js" type="text/javascript"></script>

<script language="JavaScript">
<!--
var re     = /[a-z0-9\(\)\[\]_-]/i ; // ImageName check
var reInfo = "a-z A-Z 0-9 ( ) [ ] _ -" ; // For alertBox

function doClear(){
	var f = document.forms.imgProp;
	f.imageref.value            = "";
	f.image_name.value          = "";
	f.image_width.value         = "";
	f.image_height.value        = "";
	f.image_border.value        = "";
	f.keepAspectRatio.checked   = 1;
	f.image_align.selectedIndex = 0;
	f.alt_text.value            = "";
	f.low_scr.value             = "";
	f.v_space.value             = "";
	f.h_space.value             = "";
	f.imageref_link.value       = "";
	f.target.selectedIndex      = 0;
	f.target_name.value         = "";
	if (isMoz) document.getElementById("imgTable").style.display = "none";
}

function setDef() {
	var f = document.forms.imgProp;
	if (!isNS && f.imageref.value == "") f.image_align.selectedIndex = 0;
}

function checkFileName() {
	var f = document.forms.ImageUploadForm ;
	var thePath = f.file.value ;
	var theFile = thePath;
	var isValid = true ;
    theFile = theFile.substring(theFile.lastIndexOf("/") + 1) ;
	theFile = theFile.substring(theFile.lastIndexOf("\\") + 1) ;
	theFile = theFile.substring(0, theFile.lastIndexOf(".")) ;
	theFile = unescape(theFile) ;
	for (var i = 0; i < theFile.length; i++) {
		if (!re.test(theFile.charAt(i).toString())) {
			isValid = false ;
		}
	}
	if (theFile == "") {
		alert("Du har inte valt någon bild!") ;
		return false;
	} else if (!isValid) {
		var str = "Du får inte ha mellanslag, svenska bokstäver\neller konstiga tecken i filnamnet!\nBilden kommer då inte synas i alla webläsare.\n\nDu får bara använda dessa tecken i filnamnet:\n" + reInfo + "\n\nByt namn på bilden innan du lägger upp den." ;
		alert(str);
		return false;
	} else {
		return true;
	}
}
//-->
</script>

<!-- script src="/javascript/imcms.js" type="text/javascript"></script -->

</head>
<body bgcolor="#FFFFFF" onLoad="focusField('ImageUploadForm','file'); setDef();"
>
<!-- 
<body bgcolor="#FFFFFF" onLoad="focusField('ImageUpload','file'); setDef(); openImageHelp();" onUnLoad="closeImageHelp();">
 -->
<script>
imcmsGui("outer_start", null);
imcmsGui("head", null);
</script>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
	<td>
	<table border="0" cellspacing="0" cellpadding="0">
	<form name="backForm" action="AdminDoc">
	<input type="hidden" name="meta_id" value="#getMetaId#">
	<input type="hidden" name="flags" value="131072">
	<tr>
		<td><input type="submit" class="imcmsFormBtn" value="Tillbaka"></td>
	    <td>&nbsp;</td>
        <td><input type="button" value="Hjälp" title="Öppna hjälpsidan" class="imcmsFormBtn" onClick="openHelpW(72)"></td>

	</tr>
	</form>
	</table></td>
	<td>&nbsp;</td>
	<td>
	<table border="0" cellspacing="0" cellpadding="0">
	<form name="imgbr" method="get" action="ImageBrowse">
	<input type="hidden" name="meta_id" value="#getMetaId#">
	<input type="hidden" name="img_no" value="#img_no#">
	<input type="hidden" name="label" value="#label#">
	<tr>
		<td><input type="submit" class="imcmsFormBtn" value="Välj från bildarkiv"></td>
	</tr>
	</form>
	</table></td>
</tr>
</table>
<script>
imcmsGui("mid", null);
</script>
<table border="0" cellspacing="0" cellpadding="2" width="660" align="center">
<form name="ImageUploadForm" action="ImageUpload" enctype="multipart/form-data" method="POST" onSubmit="return (checkFileName()); return false">
<input type="HIDDEN" name="meta_id" value="#getMetaId#">
<input type="HIDDEN" name="img_no" value="#img_no#">
<input type="hidden" name="label" value="#label#">
<tr>
	<td colspan="2"><script>imcHeading("Lägg till ny bild","656");</script></td>
</tr>
<tr>
	<td>Vald bild</td>
	<td><script>
writeFormField("FILE","file\" id=\"theFile",54,null,null,null);
</script></td>
</tr>
<tr>
	<td>Katalog</td>
	<td>
	<table border="0" cellspacing="0" cellpadding="0" width="100%">
	<tr>
		<td>
		<select name="folder" size="1">
			#folders#
		</select></td>
		<td align="right"><input type="submit" class="imcmsFormBtnSmall" name="ok" value="Ladda upp" style="width:110"></td>
	</tr>
	</table></td>
</tr>
</form>
<form name="imgProp" method="POST" action="SaveImage">
<input type="HIDDEN" name="meta_id" value="#getMetaId#">
<input type="HIDDEN" name="img_no" value="#img_no#">
<input type="HIDDEN" name="origW" value="#origW#">
<input type="HIDDEN" name="origH" value="#origH#">
<input type="HIDDEN" name="oldW" value="#imgWidth#">
<input type="HIDDEN" name="oldH" value="#imgHeight#">
<input type="hidden" name="label" value="#label#">
<tr>
	<td colspan="2">&nbsp;<br>
	<script>imcHeading("Redigera bild #img_no# på sida #getMetaId#","656");</script><div id="theLabel" class="imcmsAdmText"><i>#label#</i></div></td>
</tr>
<tr>
	<td colspan="2">
<script language="JavaScript">
<!--
var sUrl = "#imgUrl##imgRef#";
var str  = "";
if (sUrl.indexOf(".") < 0) {
	str += "<img src=\"@imcmsimageurllang@/admin/1x1.gif\" width=\"1\" height=\"1\" border=\"0\" style=\"display:none\">";
} else {
	str += "<table id=\"imgTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"5\" width=\"100%\">\n";
	str += "<tr>\n";
	str += "	<td align=\"center\" bgcolor=\"#ffffff\">\n";
	str += "	<img src=\"#imgUrl##imgRef#\" width=\"#imgWidth#\" height=\"#imgHeight#\" border=\"#imgBorder#\"></td>\n";
	str += "</tr>\n";
	str += "</table>";
}
document.write(str);
//-->
</script></td>
</tr>
<tr>
	<td nowrap>Bildsökväg (src)</td>
	<td>
	<table border="0" cellspacing="0" cellpadding="0" width="100%">
	<tr>
		<td><script>
writeFormField("TEXT","imageref",50,255,350,"#imgRef#");
</script></td>
		<td align="right"><input type="SUBMIT" class="imcmsFormBtnSmall" name="show_img" value="Förhandsgranska" style="width:110"></td>
	</tr>
	</table></td>
</tr>
<tr>
	<td nowrap>Bildnamn (name)</td>
	<td><script>
writeFormField("TEXT","image_name",50,255,350,"#imgName#");
</script></td>
</tr>
<tr>
	<td nowrap>Format/storlek</td>
	<td>
	<table border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td><b>Bredd</b></td>
		<td>&nbsp;</td>
		<td><b>Höjd</b></td>
		<td>&nbsp;</td>
		<td><b>Kant</b></td>
		<td colspan="3">&nbsp;</td>
	<tr>
		<td height="20">&nbsp;#origW#</td>
		<td>&nbsp;X&nbsp;</td>
		<td>&nbsp;#origH#</td>
		<td>&nbsp;</td>
		<td>&nbsp;#imgBorder#</td>
		<td>&nbsp;</td>
		<td colspan="2">(Originalstorlek)</td>
	</tr>
	<tr>
		<td><script>
writeFormField("TEXT","image_width",4,4,null,"#imgWidth#");
</script></td>
		<td>&nbsp;X&nbsp;</td>
		<td><script>
writeFormField("TEXT","image_height",4,4,null,"#imgHeight#");
</script></td>
		<td>&nbsp;</td>
		<td><script>
writeFormField("TEXT","image_border",4,4,null,"#imgBorder#");
</script></td>
		<td>&nbsp;</td>
		<td><input type="checkbox" name="keepAspectRatio" value="yes" #keep_aspect#></td>
		<td> Behåll bildens proportioner</td>
	</tr>
	</table></td>
</tr>
<tr>
	<td nowrap>&quot;Luft&quot; kring bilden (h/vspace)</td>
	<td>
	<table border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td><script>
writeFormField("TEXT","v_space",4,4,null,"#imgVerticalSpace#");
</script></td>
		<td>&nbsp;</td>
		<td>px ovan/under</td>
		<td>&nbsp; &nbsp;</td>
		<td><script>
writeFormField("TEXT","h_space",4,4,null,"#imgHorizontalSpace#");
</script></td>
		<td>&nbsp;</td>
		<td>px på sidorna</td>
	</tr>
	</table></td>
</tr>
<tr>
	<td nowrap>Nästa textfälts placering (align)</td>
	<td>
	<select name="image_align" size="1">
		<option value="none" #none_selected#>Ingen
		<option value="baseline" #baseline_selected#>Baslinje
		<option value="top" #top_selected#>Toppen
		<option value="middle" #middle_selected#>Mitten
		<option value="bottom" #bottom_selected#>Botten
		<option value="texttop" #texttop_selected#>Texttoppen
		<option value="absmiddle" #absmiddle_selected#>Exakt mitten
		<option value="absbottom" #absbottom_selected#>Längst ner
		<option value="left" #left_selected#>Bild vänster
		<option value="right" #right_selected#>Bild höger
	</select></td>
</tr>
<tr>
	<td nowrap>Text i textversion (alt)</td>
	<td><script>
writeFormField("TEXT","alt_text",92,255,"100%","#imgAltText#");
</script></td>
</tr>
<tr>
	<td colspan="2">&nbsp;<br><script>imcHeading("Länkad bild","656");</script></td>
</tr>
<tr>
	<td nowrap>Sökväg/URL (href)</td>
	<td><script>
writeFormField("TEXT","imageref_link",92,255,"100%","#imgRefLink#");
</script></td>
</tr>
<tr>
	<td nowrap>Länk öppnas i (target)</td>
	<td>
	<table border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td>
		<select name="target" size="1" onChange="document.forms.imgProp.target_name.value = document.forms.imgProp.target.options[document.forms.imgProp.target.selectedIndex].value">
			<option value="_top" #top_checked#>Aktuellt fönster
			<option value="_blank" #blank_checked#>Nytt fönster
			<option value="_parent" #parent_checked#>Moderram
			<option value="_self" #self_checked#>Samma ram
			<option value="_other" #other_checked#>Annan ram 
		</select></td>
		<td>&nbsp;&nbsp;</td>
		<td><script>
writeFormField("TEXT","target_name",10,20,null,"#target_name#");
</script></td>
	</tr>
	</table></td>
</tr>
<tr>
	<td colspan="2"><script>hr("100%", 656, "blue");</script></td>
</tr>
<tr>
	<td colspan="2" align="right">
	<input type="SUBMIT" class="imcmsFormBtn" name="ok" value="  Spara  ">
	<input type="SUBMIT" class="imcmsFormBtn" name="cancel" value=" Avbryt ">
	<input type="button" class="imcmsFormBtn" name="Rensa" value="  Rensa  " onClick="doClear();"></td>
</tr>
<tr>
	<td><img src="@imcmsimageurllang@/admin/1x1.gif" width="156" height="1"></td>
	<td><img src="@imcmsimageurllang@/admin/1x1.gif" width="1" height="1"></td>
</tr>
<input type="hidden" name="low_scr" value="#imgLowScr#">
</form>
</table>
<script>
imcmsGui("bottom", null);
imcmsGui("outer_end", null);
</script>

</body>
</html>
