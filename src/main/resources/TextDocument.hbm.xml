<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" 
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
<hibernate-mapping>

  <!-- ==================================================================== -->
  <!-- TEXT -->
  <!-- ==================================================================== -->
  <query name="Text.deleteTexts">
    <![CDATA[
    DELETE FROM Text t WHERE t.docId = :docId AND t.docVersionNo = :docVersionNo AND t.language.id = :languageId
    ]]>
  </query>

  <!-- Collection -->
  <query name="Text.getByDocIdAndDocVersionNoAndLanguageId">
    <![CDATA[
    SELECT t FROM Text t WHERE t.docId = :docId AND t.docVersionNo = :docVersionNo AND t.language.id = :languageId
    ]]>
  </query>

  <!-- Collection -->
  <query name="Text.getByDocIdAndDocVersionNo">
    <![CDATA[
    SELECT t FROM Text t WHERE t.docId = :docId AND t.docVersionNo = :docVersionNo
    ]]>
  </query>

  <!-- Unique result -->
  <query name="Text.getByDocIdAndDocVersionNoAndNoAndLanguageId">
    <![CDATA[
    SELECT t FROM Text t WHERE t.docId = :docId AND t.docVersionNo = :docVersionNo AND t.no = :no AND t.language.id = :languageId
    ]]>
  </query>

  <!-- ==================================================================== -->
  <!-- IMAGE -->
  <!-- ==================================================================== -->
  <query name="Image.deleteImages">
    <![CDATA[
    DELETE FROM Image i WHERE i.docId = :docId AND i.docVersionNo = :docVersionNo AND i.language.id = :languageId
    ]]>
  </query>

  <query name="Image.getByLanguageId">
    <![CDATA[
    select i from Image i where i.docId = :docId and i.language.id = :languageId
    ]]>
  </query>

  <!--<query name="Image.getLanguagesToImagesByDocId">-->
    <!--<![CDATA[-->
    <!--select l, i from Image i right join i.language l where (i.docId = :docId and i.no = :name) or i.docId is null order by l.default_ desc-->
    <!--]]>-->
  <!--</query>-->

  <query name="Image.getAllImages">
    <![CDATA[
    select i from Image i where i.docId = :docId
    ]]>
  </query>

  <query name="Image.getAllDocumentImagesByLanguage">
    <![CDATA[
    select i from Image i where i.docId = :docId and i.language.id = :languageId
    ]]>
  </query>

  <!--<query name="Image.getDefaultImage">-->
    <!--<![CDATA[-->
    <!--select i from Image i where i.docId = :docId and i.no = :name and i.language.default_ is true-->
    <!--]]>-->
  <!--</query>-->


  <query name="Image.getByDocIdAndDocVersionNo">
    <![CDATA[
    SELECT i FROM Image i WHERE i.docId = :docId AND i.docVersionNo = :docVersionNo
    ]]>
  </query>

  <query name="Image.getByDocIdAndDocVersionNoAndLanguageId">
    <![CDATA[
    SELECT i FROM Image i WHERE i.docId = :docId AND i.docVersionNo = :docVersionNo AND i.language.id = :languageId
    ]]>
  </query>

  <!-- ==================================================================== -->
  <!-- Menus -->
  <!-- ==================================================================== -->
  <!-- List -->
  <query name="Menu.getMenus">
    <![CDATA[
    SELECT m FROM Menu m  WHERE m.docId = :docId AND m.docVersionNo = :docVersionNo
    ]]>
  </query>

  <!-- Bulk delete -->
  <query name="Menu.deleteMenus">
    <![CDATA[
    DELETE FROM Menu m WHERE m.docId = :docId AND m.docVersionNo = :docVersionNo
    ]]>
  </query>


    <!-- ==================================================================== -->
    <!-- Content Loop -->
    <!-- ==================================================================== -->

  <!-- Unique -->
  <query name="ContentLoop.getByDocIdAndDocVersionNoAndNo">
    <![CDATA[
    SELECT l FROM ContentLoop l WHERE l.docId = :docId AND l.docVersionNo = :docVersionNo AND l.no = :no
    ]]>
  </query>


  <!-- List -->
  <query name="ContentLoop.getByDocIdAndDocVersionNo">
    <![CDATA[
    SELECT l FROM ContentLoop l WHERE l.docId = :docId AND l.docVersionNo = :docVersionNo
    ]]>
  </query>
</hibernate-mapping>