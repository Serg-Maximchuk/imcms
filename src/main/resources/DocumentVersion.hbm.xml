<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" 
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
<hibernate-mapping>
  
  <!-- Unique -->
  <query name="DocumentVersion.getLatestVersion">
    <![CDATA[
	  SELECT v FROM DocumentVersion v 
	  WHERE v.id IN (
	    SELECT max(v.id) FROM DocumentVersion v 
	    WHERE v.metaId = :metaId)
	  )    
    ]]>
  </query>
  
  <!-- Unique - HARDCODED - REWRITE -->
  <query name="DocumentVersion.getActiveVersion">
    <![CDATA[
	  SELECT v FROM DocumentVersion v 
	  WHERE v.number = 0 AND v.metaId = :metaId
    ]]>
  </query>    

  <!-- Unique -->
  <query name="DocumentVersion.getByMetaIdAndNumber">
    <![CDATA[
	  SELECT v FROM DocumentVersion v
	  WHERE v.metaId = :metaId AND v.number = :number
    ]]>
  </query>

  <!-- Collection -->
  <query name="DocumentVersion.getByMetaId">
    <![CDATA[
      SELECT v FROM DocumentVersion v WHERE v.metaId = :metaId   
    ]]>
  </query>  
  
</hibernate-mapping>