Version 1.12.0

    Of importance to administrators:

    * We're now using jTDS instead of Microsofts JDBC driver. The Microsoft driver still works,
      but it is strongly recommended that you use jTDS instead. To do this,
      change the values "JdbcDriver" and "JdbcUrl" in "server.properties" to "net.sourceforge.jtds.jdbc.Driver" and
      "jdbc:jtds:sqlserver://{host}:{port}/;AppName=imCMS;DatabaseName={databasename}" respectively,
      substituting correct values for "{host}", "{port}", and "{databasename}". (Bug 1850)
      
    Of interest to API-using developers:

    * Added classes:
        - Role - Represents a user-role.
        - SaveException - Thrown when something can't be saved.
    * Changed classes:
        - MaxCategoriesOfTypeExceededException - Extends SaveException
        - CategoryAlreadyExistsException - Extends SaveException
        - CategoryTypeAlreadyExistsException - Extends SaveException
    * Added methods:
        - User.getRoles() - Get the user's roles.
        - User.setRoles(Role[]) - Set the user's roles.
        - User.hasRole(Role) - Returns true if the user has the role.
        - User.addRole(Role) - Add a role to the user.
        - User.removeRole(Role) - Remove a role from the user.
        - UserService.deleteRole(Role) - Delete a role, requires superadmin permission.
        - UserService.getAllRoles() - Returns all roles in the system, requires superadmin permission.
        - UserService.getAllUsersWithRole(Role) - Get all users with the given permission.
        - UserService.getRole(int) - Get a role by id, requires superadmin permission.
        - UserService.getRole(String) - Get a role by name, requires superadmin permission.
        - UserService.saveRole(Role) - Save changes to the role, requires superadmin permission.
        - UserService.createNewUser(String, String) - Create a new user.
        - UserService.saveUser(User) - Save a new or existing user, requires superadmin permission.
        - User.set* - Added a bunch of setters.
        - User.get* - Added a few missing setters.
    * Changed methods:
        - UserService.addNewRole(String) - Returns the new role.
        - DocumentService.saveChanges(Document) - Throws SaveException instead of MaxCategoriesOfTypeExceededException.
    * Deprecated methods:
        - User.getRoleNames() - Use User.getRoles()
        - User.hasRole(String) - Use User.hasRole(Role)
        - UserService.deleteRole(String) - Use UserService.deleteRole(Role)
        - UserService.getAllUserWithRole(String) - Use UserService.getAllUsersWithRole(Role)
        - UserService.getRoleNames(User) - Use User.getRoles()
        - UserService.getAllRolesNames() - Use UserService.getAllRoles()
        - UserService.setUserRoles(User,String[]) - Use User.setRoles(Role[])
    * Removed methods:
        - DocumentService.createAndSaveNewTextDocument(Document) - Use DocumentService.createNewTextDocument() and
            DocumentService.saveChanges(Document)
        - DocumentService.createAndSaveNewUrlDocument(Document) - Use DocumentService.createNewUrlDocument() and
            DocumentService.saveChanges(Document)


Version 1.11.1

    Of interest to administrators:

    * In the fix to bug 2452 in 1.11.0, we changed the way files in file documents are saved to disk,
      forgetting backwards-compatibility.
      Administrators had to remove the "_se"-suffix from all files under "WEB-INF/uploads",
      or the files would not be found after an upgrade.
      This was fixed so the "_se" suffix is recognized again,
      and will be automatically removed when the file document is saved.
      Removing the suffix from the files on upgrade is still recommended. (Bug 2650)
    * On a related note, don't show "WEB-INF/uploads" in "FileAdmin" by default. (Bug 2640)
    * Made "/RD/*"-paths (as seen in the log) work again. (Bug 2633)


Version 1.11.0:

    Of importance to administrators:

    * The "SelectMethod" in the JdbcUrl in "server.properties" MUST be set to "SelectMethod=cursor",
      otherwise you will get the error "Can't start a cloned connection while in manual transaction mode."
      when you try to save a document. This is due to the new transaction code.
      The default used to be "SelectMethod=direct". (Bug 2569)

    Of interest to users:

    * Made it possible to upload several files in one filedocument. (Bug 2452)
    * Fixed a race condition that could cause menus to be cleared when editing a text-document. (Bug 2569)
    * File-extension "xls" on uploaded files is now recognized as a Microsoft Excel Spreadsheet. (Bug 2534)
    * Fixed a problem with viewing uploaded PDF files with Adobe Acrobat 6.0.1. (Bug 2511)
    * Fixed exception when trying to create an HTML-document. (Bug 2543)
    * Changed some swedish names for different document types. (Bug 1496)
    * Some form elements looked strange in "page info" in Internet Explorer 5.2 on Macintosh. (Bug 2391)
    * Fixed a bug that made it hard to remove images. (Bug 2567)
    * Show file-size on file-document-files and images. (Bug 2520)
    * Distinguish directories in "FileAdmin" with gray background color,
      sort files and directories in alphabetical order, and make file-sizes more readable. (Bug 2572)
    * Fixed a bug making it impossible to delete a text-document with more than one menu. (Bug 2585)
    * HTML is now removed from text-fields before indexing, so a search for "foo bar"
      will now also find "<em>foo</em> bar". (Bug 2593)
    * Changed swedish name of text-document, "Ny sida" to "Textsida". (Bug 1496)
    * Image-preview in old image archive was broken. (Bug 2628)
    * Submitting the form several times (i.e. by double-clicking) when creating a new document no longer results
      in an error message and several documents created. (Bug 2607)

    Of interest to template creators:

    * Put the imCMS-commercial html-comment (imcms_message.html) before the <html>-tag
      instead of the before doctype declaration. (Bug 2623)

    Of interest to administrators:

    * Disallow editing of user "user". (Bug 2479)
    * Fixed a bug that made it impossible to create a category. (Bug 2514)
    * Fixed a bug that prevented changing a category-type from multi-choice to single-choice. (Bug 2515)
    * Database connections are now tested before use. This allows imCMS to survive database server restarts. (Bug 2144)
    * "IndexingSchedulePeriodInMinutes" in "server.properties" now controls the time period
      between reindexings in minutes. (Bug 2614)
    * Reindexing is no longer performed on startup unless needed. (Bug 2625)
    * Added a little note about running SQL-scripts to INSTALL.TXT. (Bug 2484)
    * The admin button is now visible for users with role "Useradmin" again. (Bug 2629)

    Of interest to API-using developers:

    * Category now implements Comparable. Compares by name, ignoring case.
    * UserService.getUser(String) no longer requires superadmin permissions. (Bug 2527)
    * Added classes:
        - MailService - provides methods for sending e-mail. (Bug 2551)
        - Mail - represents a mail to be sent with MailService.
          Uses javax.activation.DataSource for attachments. (Bug 2551)
        - MailException - thrown by MailService. (Bug 2551)
        - FileDocument - represents a filedocument (Bug 2490)
        - FileDocument.FileDocumentFile - represents a single file in a filedocument.
          Implements javax.activation.DataSource. (Bug 2490)
    * Added methods:
        - ContentManagementSystem.getMailService() - (Bug 2551)
        - DocumentService.createNewFileDocument() - (Bug 2490)
        - DocumentService.getXmlDomForDocument() - returns an org.w3c.dom.Document representing a document.
          Currently only works with text-documents. (Bug 2551)
        - Image.getSrc(String contextPath) - returns image-src with contextPath prepended. (Bug 2491)
        - Image.getSrcRelativeToContextPath() - returns image-src without contextPath prepended. (Bug 2491)
        - Image.getSize() - returns the size of the image in bytes. (Bug 2491)
        - User.getId() - returns the user id. (Bug 2616)
        - User.isDefaultUser() - returns true if the user is the default user ("user/user"). (Bug 2616)
        - DocumentPermissionSet.getEditMenusPermission() - returns true if this permission-set
          allows editing of menus. (Bug 2609)
        - DocumentPermissionSet.setEditMenusPermission(boolean) - sets whether this permission-set
          allows editing of menus. (Bug 2609)
    * Removed methods:
        - Image.getSrc() - use Image.getSrc(String contextPath) or Image.getSrcRelativeToContextPath() (Bug 2491)
        - Image.getSrcUrl() - use Image.getSrc(String contextPath) or Image.getSrcRelativeToContextPath() (Bug 2491)
        This was necessary to completely remove imCMS dependence on a specific context path.
    * Removed deprecated fields:
        - Document.Comparator.ACTIVATED_DATETIME - use Document.Comparator.PUBLICATION_START_DATETIME
    * Removed deprecated methods
        - Document.setModifiedDateTime(Date) - use Document.setModifiedDatetime(Date)
        - Document.getModifiedDateTime() - use Document.getModifiedDatetime()
        - Document.getCreatedDateTime() - use Document.getCreatedDatetime()
        - TextDocument.getMenuSortOrder() - use Menu.getSortOrder() (Bug 2560)
        - TextDocument.setMenuSortOrder(int) - use Menu.setSortOrder(int) (Bug 2560)
        - DocumentPermissionSet.getEditHeadlinePermission() -
          use DocumentPermissionSet.getEditDocumentInformationPermission() (Bug 2609)
        - DocumentPermissionSet.setEditHeadlinePermission(boolean) -
          use DocumentPermissionSet.setEditDocumentInformationPermission(boolean) (Bug 2609)
        - DocumentPermissionSet.getEditableMenuDocumentTypeNames() - removed, returning type-names is broken. (Bug 2609)

    Of interest to developers:

    * The document-deletion procedure is now run in an transaction. (Bug 2495)
    * It's now possible to send attachments with mails.
      This uses the Java Activation Framework (javax.activation) and JavaMail API implementations from the
      GNU classpathx project. (Bug 2542)
    * Replaced imCMS own image-parsing routines with javax.imageio.ImageIO (Bug 2493)
    * Started to change the database API to allow for transactions. (Bug 2569)
    * Text document menus are now saved inside a transaction. (Bug 2569)


Version 1.10.3:

    Of interest to API-using developers:

    * Added constants for use in search-strings:
        - TextDocument.TYPE_ID
        - UrlDocument.TYPE_ID
    * Added methods:
        - boolean User.isSuperAdmin()
        - boolean User.canEdit(Document) (Bug 2521)
        - String[] User.getRoleNames() (Bug 2521)
        - DocumentService.createNewTextDocument(Document)
        - DocumentService.createNewUrlDocument(Document)
    * Deprecated methods:
        - DocumentService.createAndSaveNewTextDocument(Document)
        - DocumentService.createAndSaveNewUrlDocument(Document)

    Of interest to administrators:

    * The ldap implementation should no longer be dependent on Microsoft Active Directory.
      Rewrote a big part of the ldap-configuration in "server.properties":
        - "LdapUserName" is replaced by "LdapBindDn",
        - "LdapUserObjectClass" is set to "inetOrgPerson" by default.
        - "LdapUserIdentifyingAttribute" is replaced by "LdapUserAttribute.LoginName" which is only
          required if not using 'uid' in the "inetOrgPerson" objectclass.
      Ldap-attributes can now be arbitrarily mapped to user-properties.
      See the comments in "server.properties" for details.
      (Bug 1981, bug 2516)
    * Fixed a bug where removing a single phone number from a user had no effect. (Bug 2471)
    * Use dos-style line-endings in the text-files in the zip file,
      and unix-style line-endings in the tarball. (Bug 2485)

    Of interest to developers:

    * Instead of empty strings, use "localhost" for default database-host
      and "imcms" for default database-name. (Bug 2488)


Version 1.10.2:

    Of interest to API-using developers:

    * Added method Image.isEmpty() to determine whether an image is empty or not. (Bug 2344)
    * Image.getWidth() and Image.getHeight() now return the actual size of the image as it will be displayed,
      instead of 0, unless the actual size couldn't be determined. (Bug 2475)

    Bugs fixed:

    * Fixed a bug which caused includes to be done with the included document in adminmode. (Bug 2449)
    * Image-tags containing filedocument-images are hidden from users without permissions
      to the filedocument. (Bug 2454)
    * Fixed a mistake which prevented the imCMS-advertisement in "imcms_message.html"
      from being output at the beginning of every page. (Bug 2445)
    * Allow files with extensions "jsp" and "js" to be edited in the file administrator ("FileAdmin"). (Bug 2406)
    * Build a zip file/tarball so people don't have to download more than one file. (Bug 2460)
    * Fixed a number of problems with the conference login. (Bug 2419)
    * Fixed a bug with the linkeditor in browsers other than Internet Explorer. (Bug 2462)
    * Made the html-editor optional through the use of a cookie. (Bug 2327)
    * Fixed a bug with creating external links in the html-editor. (Bug 2418)
    * Fixed a couple of bugs related to creating new conferences and new conference-users. (Bugs 2461, 2466)
    * Made listing many users somewhat quicker. (Bug 2316)


Version 1.10.1:

    * Fixed exception and possible menu-deletion when trying to readd an already existing document
      to a menu sorted by "manual" order. (Bug 2443)

    * Included both english and swedish sql scripts in the distribution.


Version 1.10.0:

    Of interest to users:

    * Filedocuments of types "png", "gif", or "jpeg" can now be used as images. (Bug 2128)
    * Completely redid the image-selecting interface to allow for the new filedocuments-as-images paradigm. (Bug 2128)
    * Replaced dropdown for selecting document publisher with a user-select dialog,
      and made the document creator settable in the same manner. (Bug 2149)
    * Allow filedocument filenames of up to 255 characters, truncating somewhat intelligently if needed. (Bug 2088)
    * Only show links to documents which the user has at least read permission on,
      or which are visible to non-authorized users. (Bug 2387)
    * Fixed exception when adding documents to a menu sorted by "manual" order. (Bug 2390)
    * Setting the modified time of a document is now possible,
      but it will still be updated the next time the document is modified. (Bug 2367)

    Of interest to template creators:

    * The label attribute now works for the include-tag: <?imcms:include label="Include label"?> (Bug 1622)
    * The outputdescription-attribute of the documentcategories tag now takes two values, "true" or "only" (Bug 2151):
        - "true": <?imcms:documentcategories outputdescription="true"?> will output "categoryname - categorydescription"
        - "only": <?imcms:documentcategories outputdescription="only"?> will output "categorydescription"
        - Not present: <?imcms:documentcategories?> will output "categoryname".

    Of interest to administrators:

    * The file "host.properties" is gone, and everything is put in "server.properties". (Bug 2424)
    * Worked a little more on indexing robustness. (Bug 2354)
    * Made the indexing work at a lower priority. (Bug 2362)
    * Remove documents from the index when deleted. (Bug 2365)
    * Fixed a bug in the linkchecker where some broken links would be flagged as OK. (Bug 2336)
    * If "SessionCookieDomain" is set in "server.properties",
      a second JSESSIONID cookie will be set with the given domain. (Bug 1886)

    Of interest to API-using developers:

    * Added methods TextDocument.getTextFields(), TextDocument.getImages(), and TextDocument.getIncludes() (Bug 2344)
    * Added accessors Document.setVisibleInMenusForUnauthorizedUsers(boolean visibleInMenusForUnauthorizedUsers)
      and Document.isVisibleInMenusForUnauthorizedUsers() (Bug 2351)
    * Added accessor Document.setCreator(User creator) (Bug 2388)
    * Added method Document.getDocumentPermissionSetForUser() (Bug 2153)
    * Added accessors TextDocument.Menu.getSortOrder() and TextDocument.Menu.setSortOrder(int sortOrder) (Bug 2438)
    * Added method TextDocument.getMenus() (Bug 2438)

    Of interest to developers:

    * Removed user-"categories". (Bug 2149)
    * Refactored the code for creating and editing documents. (Bug 2039)


Version 1.9.3:

    * Only show links to documents which the user has at least read permission on,
      or which are visible to non-authorized users. (Bug 2387)


Version 1.9.2:

    * Fixed exception when adding documents to a menu sorted by "manual" order. (Bug 2390)
    * Remove documents from the index when deleted. (Bug 2365)


Version 1.9.1:

    * Made the indexing a little more robust. (Bugs 2354, 2361, 2362)


Version 1.9.0:

    Of interest to users:

    * Simple/advanced view toggle for docinfo.
    * Admin-pages will now work on non-javascript-enabled browsers.
    * All admin-pages now use the new blue/white look.
    * The link checker will now also check linked images and urls in text-fields.
    * "Administer conferences" functionality moved to "List new/updated pages".
    * The session counter now counts sessions, not logins.
      This means that each visitor is only counted once per browser session,
      instead of once when entering the site and then again when logging in.

    Of interest to template creators:

    * New template tag: <?imcms:contextpath?> will be replaced by the "context path" of the webapp.
      The context path is the root path to the webapp, usually the name of the webapp preceded by a slash,
      for example "/imcms". This is useful when one wants to construct an absolute URL.
      Example: <img src="<?imcms:contextpath?>/images/imCMSpower.gif" alt="Powered by imCMS">

    Of interest to administrators:

    * The webapp should now be possible to rename without having to change any templates.
    * We now return correct HTTP status codes: 404 for "Not found", and 403 for "Forbidden/Permission denied".
    * Changed database parameters to allow for different database-drivers:
      The parameters "Url", "Host", "Port", "DatabaseName" in imcms/WEB-INF/conf/server.properties were replaced
      by the single option "JdbcUrl",  which for the Microsoft JDBC driver maps to the old parameters as follows:
      jdbc:microsoft:sqlserver://<Host>:<Port>;DatabaseName=<DatabaseName>
    * The "MaxConnectionCount" in server.properties is ignored by the Microsoft JDBC Driver, unless one sets
      the driver parameter "SelectMethod" to "cursor".
      To do this, append ";SelectMethod=cursor" (note the semicolon) to the JdbcUrl.
      The default is "SelectMethod=direct", and this causes the MS JDBC driver to clone connections internally.
      See http://support.microsoft.com/default.aspx?scid=kb;EN-US;313220 for more information.
    * Conference, billboard, and chat should now work on case sensitive filesystems, for example on linux.
    * Reindexing of documents is now scheduled every 24 hours from startup. Reindexing is done to
      a new directory, "imcms/WEB-INF/index.new",  which replaces the current index "imcms/WEB-INF/index" when complete.

    Of interest to API-using developers:

    * Moved the apisamples from "/apisamples/" to "/imcms/docs/apisamples/".
    * DocumentService.saveChanges(Document) is now synchronized as a poor mans transaction to prevent database conflicts.
    * Added method DocumentService.getCategoryType(int categoryTypeId)
    * Added method DocumentService.createNewCategoryType(String name, int maxChoices)
    * Added method DocumentService.createNewCategory(String name, String description, String imageUrl, CategoryType categoryType)
    * Added method TemplateService.getAllTemplateGroups()
    * Added accessors Template.getId() and TemplateGroup.getId().
    * Added convenience method DocumentService.parseLuceneSearchQuery(String) which returns a SearchQuery parsed according
      to Lucene syntax, see http://jakarta.apache.org/lucene/docs/queryparsersyntax.html

    Of interest to developers:

    * Cleaned up the file organization in the project.
    * Renamed all the ant-targets using more consistent names.
    * The API now has its own connection pool,
      so developers using the API can't accidentally starve the system of connections.
    * Jakarta Velocity (http://jakarta.apache.org/velocity/) can now be used in admintemplates and JSP-pages.
    * Searchable tokens in the index may now only consist of letters, digits, and underscores, instead of non-whitespace.
      This makes html index a little bit better, so that for example <b>bold</b> is indexed as two words ("b" and "bold").
    * There's a new test for checking which language properties are in use,
      run with the ant target "check-language-properties-in-use".
