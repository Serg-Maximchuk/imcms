<?xml version="1.0" encoding='ISO-8859-1'?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
                      "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">

<article class="whitepaper">

  <articleinfo>
    <author>
      <firstname>Christoffer</firstname>
      <surname>Hammarström</surname>
    </author>
  </articleinfo>

  <sect1>
    <title>Inledning.</title>
    <para>
        <quote>A few months in the laboratory can often save a few hours in the library.</quote>
    </para>
    <sect2>
      <title>Om det här dokumentet.</title>
      <para>
        Många människor är rädda för att lära sig nya saker, mest för att de inte
	tycker att de har tid, ork, eller lust.
      	Syftet med det här dokumentet är att visa att det är mycket enkelt att använda CVS.
      </para>
      <para>
	Detta är dessutom mitt första försök att skriva någonting i <quote>DocBook</quote>.
	DocBook är ett dokumentationsformat i SGML/XML,
	som man kan översätta till många andra format.
	Så syftet med det här dokumentet är också att visa att det inte är svårt
	att skriva flexibel dokumentation i DocBook.
      </para>
      <para>
	<ulink url="cvsdok.xml">Källkoden till detta dokument.</ulink>
      </para>
    </sect2>
  </sect1>

  <sect1>
    <title>CVS</title>

    <para>
      <footnote id="userfriendly">
	<para>
	  Notera att <quote>användar-vänlighet</quote> är
	  något som är mycket subjektivt.
  	  Många människor anser att ett massa färgade rutor med val som man kan klicka på är användar-vänliga.
	  Det finns de som anser att dylika gränssnitt bara är i vägen,
	  och anser att gränssnitt med högre signal/brus-kvot är användar-vänliga.
	  Här menas den tidigare betydelsen, men författaren föredrar den senare.
	</para>
      </footnote>
    </para>

    <sect2>
      <title>Vad är CVS?</title>
      <para>
        CVS är ett versionshanteringssystem.
        Det är mycket populärt, och de facto standard inom open source-världen.
        Det används av bl.a. <ulink url="http://www.apache.org/">Apache</ulink>,
        <ulink url="http://www.gnome.org/">Gnome</ulink>, <ulink url="http://www.sourceforge.net/">Sourceforge</ulink>,
        och många andra.
        CVS går att finna på <ulink url="http://www.cvshome.org/">http://www.cvshome.org/</ulink>.
      </para>
    </sect2>

    <sect2>
      <title>Varför använda CVS?</title>
      <para>
        Att använda CVS ger mängder av fördelar, men de enligt min mening främsta är:
        <itemizedlist>
	  <listitem>
	    <para>
	      Man har <emphasis>ett</emphasis> ställe för
	      <emphasis>all</emphasis> källkod.
              <footnote id="source">
	        <para>
	          Med <quote>källkod</quote> avses alla filer som inte går att generera från andra filer,
	          vare sig det rör sig om text- eller binär-filer, program-kod, html-dokument, bilder, och så vidare.
	          Alltså, de filer som man genererar andra filer från, med hjälp av diverse kompilatorer och liknande.
	        </para>
              </footnote>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Utvecklarna slipper oroa sig för backuper.
            </para>
	  </listitem>
	  <listitem>
	    <para>
              Utvecklarna slipper fundera på vilka filer som utgör den senaste versionen.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      CVS gör det lätt för många utvecklare att arbeta med källkod samtidigt.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Man kan se vem som har gjort vad, i vilka filer, och när.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Man kan lätt <quote>ogöra</quote> misstag.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Man kan lätt checka ut en annan uppsättning av kod man redan har utcheckad någon annanstans,
	      men som man till exempel kanske inte för tillfället kan kompilera, på grund av stora ändringar
	      eller för att man bara behöver göra en liten fix som ej är relaterad till det man gör annars.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      CVS är mycket lätt att plugga in egna script i, för att få det att göra som man vill.
	      CVS formar sig till utvecklingsmodellen, så att inte utvecklingsmodellen måste forma
	      sig efter CVS.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      CVS är <quote>standard</quote>,
	      har många användare, och är helt öppet.
	      Det finns mängder av verktyg som på ett eller annat sätt kan arbeta med CVS.
	      Många utvecklingsverktyg har stöd för CVS <quote>out of the box</quote>.
	    </para>
	  </listitem>
	</itemizedlist>
      </para>
    </sect2>

    <sect2>
      <title>Vad behöver man?</title>
      <para>
        För att kunna använda CVS måste man ha en CVS-klient,
	som kan prata med CVS-servern.
      </para>
      <para>
	Det finns ett antal
	användar-vänliga<footnoteref linkend="userfriendly">
	CVS-klienter som ger en fin vy över filerna i CVSen,
	och menyer fulla av val.
	Några av dessa går att finna på
	<ulink url="http://www.cvsgui.org/">http://www.cvsgui.org/</ulink>.
      </para>
      <para>
	Problemet med dessa är att det lätt blir överväldigande för en nybörjare
	med alla val man kan göra utan att veta vad något av dem betyder.
	Det är dessutom lätt hänt att man råkar slinta i någon
	meny någonstans, och gör något man inte tänkt göra.
      </para>
      <para>
	Detta dokument behandlar enbart kommandorads-klienten,
	som man laddar ned från <ulink url="http://www.cvshome.org/downloads.html">http://www.cvshome.org/</ulink>.
      </para>
    </sect2>

  </sect1>

  <!-- Den här sektionen innehåller mycket som är specifikt för Microsoft Windows,
       och innehåller därför mycket markup som är lämpligt för filer, miljövariabler,
       gui-element, och liknande. -->

  <sect1>
    <title>Att konfigurera CVS-klienten på <trademark>Microsoft Windows</trademark></title>
    <para>
      För att konfigurera kommandorads-klienten på <trademark>Windows</trademark> bör man göra två saker:
    </para>
    <sect2>
      <title>Lägga CVS i miljövariabeln <envar>PATH</envar></title>
      <para>
	Man bör lägga cvs-klienten i en sökväg som refereras av miljövariabeln <envar>PATH</envar>.
	<envar>PATH</envar> anger för systemet var den ska leta efter körbara filer som inte ligger
	i den katalog i vilken man befinner sig.
	Detta är inte nödvändigt, men struntar man i detta
	är man tvungen att skriva hela sökvägen till CVS varje gång
	man ska göra något, och det blir väldigt jobbigt.
      </para>
      <para>
	Enklast är att man bara lägger cvs-program-filen (<filename>cvs.exe</filename>)
	i katalogen <filename class="directory">C:\WINNT</filename>.
	eftersom <filename class="directory">C:\WINNT</filename> redan ligger i <envar>PATH</envar>.
        Detta kan man göra genom att högerklicka med musen på 
	<guiicon>Den här datorn</guiicon>, och välja
	<menuchoice>
	  <guimenu>Egenskaper</guimenu>
          <guisubmenu>Avancerat</guisubmenu>
          <guimenuitem>Miljövariabler</guimenuitem>
        </menuchoice>.
	Där finns en lista, i vilken <envar>PATH</envar> borde finnas.
      </para>
      <para>
	Om man inte vill lägga cvs-klienten i <filename class="directory">C:\WINNT</filename>
	så kan man lägga till sökvägen till <filename>cvs.exe</filename> i <envar>PATH</envar>.
	<example>
	  <title><envar>PATH</envar></title>
	  <para>
	    Om du lägger <filename>cvs.exe</filename> i katalogen <filename class="directory">C:\CVS</filename>,
	    och din nuvarande <envar>PATH</envar> är
	    <quote><computeroutput>C:\WINNT;C:\WINNT\SYSTEM32</computeroutput></quote>
	    så ska du ändra din <envar>PATH</envar> till
	    <quote><computeroutput>C:\WINNT;C:\WINNT\SYSTEM32;C:\CVS</computeroutput></quote>.
	  </para>
	</example>
      </para>
    </sect2>
    <sect2>
      <title>Ställa in miljö-variabeln <envar>CVSROOT</envar></title>
      <para>
        <envar>CVSROOT</envar> anger för CVS vilken som är din vanliga CVS-server.
	Detta är liksom <envar>PATH</envar> inte nödvändigt att ställa in, men det
	sparar tid i längden.
      </para>

      <para>
        <envar>CVSROOT</envar> innehåller en sträng i formen
	<userinput><replaceable>:access-metod:användarnamn@server-address:server-sökväg</replaceable></userinput>.
      </para>
      <para>
	Denna talar om för CVS på vilket sätt servern ska kommas åt, och för vilken användare.
	Om du inte har ett konto på CVS-servern måste du be CVS-administratören om ett.
	<example>
	  <title><envar>CVSROOT</envar></title>
	  <para>
	    <quote><userinput>:pserver:anonymous@hate:/home/cvs</userinput></quote> talar om för CVS att
	    servern <quote>hate</quote> kör en <quote>pserver</quote> (password server),
	    och att man vill ansluta som CVS-användare <quote>anonymous</quote>.
	  </para>
	</example>
      </para>
    </sect2>
  </sect1>

  <sect1>
    <title>De första stapplande stegen.</title>
    <para>
      Vi ska nu logga in till CVS-servern, och checka ut ett projekt.
      Dessa två aktiviteter gör man inte särskilt ofta.
      Loggar in gör man bara när man ska prata med en ny CVS-server för första gången,
      och checkar ut ett projekt gör man bara när man behöver en helt ny uppsättning filer att börja med.

    </para>

    <sect2>
      <title>Logga in.</title>
      <para>
        Om du nu har ställt in <envar>CVSROOT</envar> ordentligt
        <footnote id="cvsroot">
          <para>
	    Om du inte har satt <envar>CVSROOT</envar>,
	    så kan du istället ange din <envar>CVSROOT</envar>
	    till <command>cvs</command> med parametern <parameter>-d</parameter> varje gång.
	    <example>
	      <title>cvs -d</title>
	      <para>
	        <synopsis>
	          <command>cvs -d :pserver:anonymous@hate:/home/cvs login</command>
                </synopsis>
	      </para>
	    </example>
	  </para>
        </footnote>,
	så ska det räcka med att skriva:
	<synopsis>
	  <command>cvs login</command>
	</synopsis>
	för att logga in till servern.
      </para>
      <para>
	CVS kommer att connecta till CVS-servern,
	och om den lyckas får du skriva in ditt lösenord.
	Om du loggar in som en anonym användare,
	kanske det räcker med att bara trycka
	<keycap>Enter</keycap>,
	för tomt lösenord.
	<example>
	  <title>cvs login</title>
	  <para>
  	    <screen>
	      <prompt>C:\> </prompt><command>cvs login</command>
	      Logging in to :pserver:anonymous@hate:2401/home/cvs
	      <prompt>CVS password:</prompt> <replaceable>skriv lösenordet här</replaceable>
	    </screen>
	  </para>
	</example>
      </para>
    </sect2>

    <sect2>
      <title>Checka ut.</title>
      <para>
        Nu är det äntligen dags att checka ut!
	Navigera till en position i filsystemet där du vill att de utcheckade filerna ska hamna.
	Detta gör du bland annat med kommandot <command>cd</command>.
	<example>
	  <title>cd</title>
	  <para>
	    <screen>
	      <prompt>C:\> </prompt><command>d:</command>
              <prompt>D:\> </prompt><command>cd \projekt</command>
	      <prompt>D:\projekt> </prompt>
	    </screen>
	  </para>
        </example>
      </para>

      <para>
        När du bestämt dig för var filerna ska ligga skriver du:
	<synopsis>
	  <prompt>D:\projekt> </prompt><command>cvs checkout <replaceable>projekt</replaceable></command>
	</synopsis>
	Där <replaceable>projekt</replaceable> är det projekt du vill checka ut från CVS-servern.
	<footnote id="cvsprojekt">
	  <para>
	    Om du inte vet vad du vill checka ut,
	    så finns det tyvärr ofta inget enkelt sätt att ta reda på det.
	    Men, om du inte visste vad du ska checka ut skulle du nog inte läsa det här, eller hur?
	  </para>
	</footnote>
	<example>
	  <title>cvs checkout</title>
	  <para>
	    <screen>
	      <prompt>D:\projekt> </prompt><command>cvs checkout imCMS</command>
	    </screen>
	  </para>
        </example>
      </para>
      <para>
        CVS checkar ut projektet, och bygger samma filstruktur på din disk som den som ligger på CVS-servern,
	med de allra färskaste versionerna av alla filer.
      </para>
    </sect2>

  </sect1>

  <sect1>
    <title> Att arbeta med filer i CVS. </title>
    <para>
      När du har checkat ut filer från CVS så har du en exakt kopia av den filstruktur som finns på CVS-servern,
      samma filstruktur som alla i projektet använder.
      När du vill göra några ändringar i en fil, så behöver du bara öppna filen i din favorit-editor,
      göra ändringarna, och spara.
      För att dagligen arbeta med CVS är det bara två kommandon du måste kunna: <command>update</command> och <command>commit</command>.
    </para>
    <sect2>
      <title>Uppdatera.</title>
      <para>
        Allt eftersom andra utvecklare gör ändringar i filer och checkar in dem i CVS-servern
        så kommer dina filer ur synk.
	För att komma i synk igen utför du kommandot:
	<synopsis>
	  <command>cvs update</command>
	</synopsis>
	CVS kontaktar servern och jämför dina filer med de som ligger på servern.
	CVS listar alla filer som har ändrat sig,
	var och en med en bokstav framför, för att indikera status på filen.
	<example>
	  <title>cvs update</title>
	  <para>
            <screen>
	      <prompt>D:\projekt\imCMS> </prompt><command>cvs update</command>
	      cvs server: Updating .
	      cvs server: Updating 1.3
	      ? 1.3/unknown.file
	      C 1.3/build.xml
	      R 1.3/cvstest
	      cvs server: Updating 1.3/install
	      cvs server: Updating 1.3/install/conf
	      M 1.3/install/conf/log4j.xml
	      cvs server: Updating 1.3/servlets
	      A 1.3/servlets/HelloWorld.java
	      cvs server: Updating 1.3/sql
	      cvs server: Updating 1.3/sql/diff
	      U 1.3/sql/diff/diff.sql
	      cvs server: Updating 1.3/sql/sprocs
	      P 1.3/sql/sprocs/sprocs.ascii.sql
	    </screen>
	  </para>
	</example>
      </para>
      <sect3>
        <title> cvs update - statusindikatorer </title>
	<segmentedlist>
	  <title> cvs update - statusindikatorer </title>
	  <segtitle> status </segtitle> <segtitle> betydelse </segtitle>
	  <seglistitem>
	    <seg>A</seg><seg>(Added) En fil du har markerat som tilllagd i din kopia, som ännu inte finns i CVS-servern.</seg>
	  </seglistitem>
	  <seglistitem>
	    <seg>R</seg><seg>(Removed) En fil som finns i CVS-servern, men som du har markerat borttagen i din kopia.</seg>
	  </seglistitem>
	  <seglistitem>
	    <seg>M</seg><seg>(Modified/Merged) En fil som du har ändrat på. CVS-servern kan ha kombinerat din fil med den senaste från CVS-servern utan problem.</seg>
	  </seglistitem>
	  <seglistitem>
	    <seg>P</seg><seg>(Patched) Din fil var gammal, och blev <quote>patchad</quote> till senaste versionen.</seg>
	  </seglistitem>
	  <seglistitem>
	    <seg>U</seg><seg>(Updated) Din fil var gammal, eller fanns inte, och du fick en helt ny från servern.</seg>
	  </seglistitem>
	  <seglistitem>
	    <seg>?</seg><seg>(Okänd) En fil som inte finns i CVS-servern, och som du inte har markerat som tillagd i din kopia.</seg>
	  </seglistitem>
	  <seglistitem>
	    <seg>C</seg>
	    <seg>(Conflict) Du har ändrat på den här filen, 
	         och det har någon annan också.
                 CVS-servern har misslyckats med att kombinera
                 din kopia med den från servern,
		 och har i din fil markerat dina ändringar
		 och ändringarna från CVS-servern,
		 med så kallade <quote>conflict markers</quote>:
		 <quote>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</quote>
		 <quote>========</quote>
		 <quote>>>>>>></quote>.
		 Detta måste åtgärdas innan du kan checka in den här filen.
            </seg>
	  </seglistitem>
	</segmentedlist>
      </sect3>
    </sect2>

    <sect2>
      <title>Checka in.</title>
      <para>
        Du har ändringar i dina filer som du vill checka in i CVS-servern,
        så att de blir <quote>officiella</quote> och så att
        andra kan ta del av dem.
        Du har även uppdaterat ut från CVS-servern så att du är i synk och känner till
        ändringar på filer, och eventuella konflikter.
        För att checka in utför du kommandot:
        <synopsis>
          <command>cvs commit <replaceable>filnamn</replaceable></command>
        </synopsis>
        Där <replaceable>filnamn</replaceable> är sökvägen till filen/filerna som du vill checka in.
        CVS jämför dina filer med de som ligger på CVS-servern, precis som vid en update,
        sammanställer en lista på de som har ändrat sig, och startar en editor
        (vanligtvis <application>notepad</application> på <trademark>Windows</trademark>).
        I editorn skriver du en kommentar om dina ändringar, vad du har gjort och varför.
        Ju mer uttömmande det är desto bättre, men viktigast är att syftet med dina ändringar blir klart.
        Sedan sparar du filen och stänger editorn, så fortsätter CVS med incheckningen.

        <warning>
	  <para>
	    Var noga med att bara ange alla 
	    de filer som innehåller de ändringar du har gjort som är relevanta.
	    Om du utför kommandot <command>cvs commit</command> utan att ange filnamn
	    plockas alla ändringar du har gjort i alla filer
	    i katalogen du befinner dig i och dess underkataloger.
	    Tänk på att <command>cvs commit</command> är det kommando som
	    utför ändringar i filerna på CVS-servern.
	    Misstag är enkla att fixa, men det kan ta tid innan de upptäcks.
	  </para>
        </warning>

      </para>
    </sect2>
  </sect1>

  <sect1>
    <title> Lägga till och ta bort filer </title>
    <para>
      Du har gjort stora ändringar, lagt till några nya filer, tagit bort några gamla filer som blivit onödiga.
      Du behöver <command>cvs add</command> och <command>cvs remove</command>.
    </para>
    <sect2>
      <title>Lägga till filer.</title>
      <para>
        Du har en fil som du vill lägga till i filstrukturen på CVS-servern.
	För detta använder du kommandot
	<synopsis>
	  <command>cvs add <replaceable>filnamn</replaceable></command>
	</synopsis>
	där <replaceable>filnamn</replaceable> är sökvägen till
	filen/filerna/katalogen/katalogerna som du vill lägga till.
	<example>
	  <title>cvs add</title>
	  <para>
            <screen>
	      <prompt>D:\projekt\imCMS> </prompt> <command>cvs add cvstest</command>
	      cvs server: scheduling file `cvstest' for addition
	      cvs server: use 'cvs commit' to add this file permanently
	    </screen>
	  </para>
	</example>
	<note>
	  <para>
	    Notera att filen inte läggs till i CVS-servern med en gång, utan den markeras bara tillagd i din kopia.
	    Nästa gång du utför <command>cvs commit</command> kommer filen att läggas till i CVS-servern.
	  </para>
	</note>
      </para>
    </sect2>
    <sect2>
      <title>Ta bort filer.</title>
      <para>
        Du har en fil som du ta bort ur filstrukturen på CVS-servern.
	För detta använder du kommandot
	<synopsis>
	  <command>cvs remove <replaceable>filnamn</replaceable></command>
	</synopsis>
	där <replaceable>filnamn</replaceable> är sökvägen till
	filen/filerna som du vill ta bort.
	<example>
	  <title>cvs remove</title>
	  <para>
            <screen>
	      <prompt>D:\projekt\imCMS> </prompt> <command>cvs remove cvstest</command>
	      cvs server: scheduling `cvstest' for removal
	      cvs server: use 'cvs commit' to remove this file permanently
	    </screen>
	  </para>
	</example>
	<note>
	  <para>
	    Notera att du måste radera filen från din egen kopia för att det här kommandot ska fungera.
	    Notera också att filen inte tas bort ur CVS-servern med en gång, utan den markeras bara borttagen i din kopia.
	    Nästa gång du utför <command>cvs commit</command> kommer filen att markeras borttagen i CVS-servern, och stoppas undan.
	  </para>
	</note>
	<tip>
	  <para>
	    Du kan ange parametern <parameter>-f</parameter> till <command>cvs remove</command>
	    så raderar cvs filen åt dig.
	    Det säger dock sig självt att man måste vara försiktig så man inte anger fel filer.
	    <example>
	      <title>cvs remove -f</title>
	      <para>
	        <synopsis>
		  <command>cvs remove -f cvstest</command>
		</synopsis>
	      </para>
	    </example>
	  </para>
	</tip>
      </para>
    </sect2>
  </sect1>

  <sect1>
    <title> Generell syntax </title>
    <para>
      CVS-kommandot har följande syntax:
      <cmdsynopsis>
        <command>cvs</command>
	<arg choice="opt">cvs-parametrar</arg>
	<arg choice="plain">cvs-kommando</arg>
	<arg choice="opt">cvs-kommando-parametrar</arg>
	<arg choice="opt">fil ...</arg>
      </cmdsynopsis>

      <itemizedlist>
        <listitem>
	  <para>
	    <parameter>cvs-parametrar</parameter> är generella parametrar som gäller för alla cvs-kommmandon.
	  </para>
	</listitem>
	<listitem>
	  <para>
            <parameter>cvs-kommando</parameter> är det cvs-kommando man vill utföra,
	    till exempel <quote>add</quote>,<quote>login</quote>,<quote>update</quote>, och så vidare.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <parameter>cvs-kommando-parametrar</parameter> är parametrar som är specifika för varje cvs-kommando.
	    <important>
	      <para>
	        Märk väl att de parametrar som är tillåtna här är helt skilda från de parametrar som kommer före cvs-kommandot.
		<command>cvs -f commit</command> är något <emphasis>helt</emphasis> annat än <command>cvs commit -f</command>!
	      </para>
	    </important>
	  </para>	 
	</listitem>
      </itemizedlist>

      <tip>
        <title> Hjälpen är nära! </title>
        <para>
          Du kan alltid skriva <command>cvs --help</command> för att få generell hjälp.
	  Vill du ha hjälp med ett specifikt kommando så kan du använda
	  <command>cvs -H <replaceable>kommando</replaceable></command>
	  där <replaceable>kommando</replaceable> är kommandot du behöver hjälp med.
	  <example>
	    <title>cvs -H</title>
	    <para>
	      <synopsis>
	        <command>cvs -H update</command>
	      </synopsis>
	    </para>
	  </example>
	</para>
      </tip>
    </para>
  </sect1>
</article>
